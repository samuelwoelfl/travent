<!DOCTYPE html>
<html lang="en" data-theme="theme-light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>travent</title>
  <link rel="shortcut icon" href="img/logo/icon.svg">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/cookies.css">

  <link rel="stylesheet" href="https://anandchowdhary.github.io/ionicons-3-cdn/icons.css" integrity="sha384-+iqgM+tGle5wS+uPwXzIjZS5v6VkqCUV7YQ/e/clzRHAxYbzpUJ+nldylmtBWCP0" crossorigin="anonymous">

  <!-- jQuery Stuff -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  </script>
  <!-- iCal Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ical.js/1.5.0/ical.min.js" integrity="sha512-0izBc1upGYnrS1u1MX7QR+sjFIxZWxLVdNI7cUoHHCutDr5ENjuQRZuS+v+3NFNGfwHSrPoHzBzED0rV651tGw==" crossorigin="anonymous" referrerpolicy="no-referrer">
  </script>
  <!-- Cookies Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js" integrity="sha512-Meww2sXqNHxI1+5Dyh/9KAtvI9RZSA4c1K2k5iL02oiPO/RH3Q30L3M1albtqMg50u4gRTYdV4EXOQqXEI336A==" crossorigin="anonymous" referrerpolicy="no-referrer">
  </script>
  <!-- fill css prefixes for browsers -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
  <!-- Google API -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD428BZelApsygZBJJlGJXvmCzBNldPTSY&libraries=places&callback=initMap">
  </script>
  <!-- Lootie Files -->
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <!-- Custom Scripts -->
  <script src="js/form.js"></script>
  <script src="js/formSave.js"></script>
  <script src="js/cookies.js"></script>

</head>

<body>

  <div class="cookie_toggle_modal">
    <span class="icon">üç™</span>
    <div class="hidden">
      <span class="text">Cookie&nbsp;Settings:</span>
      <button id="toogle_cookies_button" class="primary" type="button" name="button">Accept Cookies</button>
    </div>
  </div>

  <div id="cookie_banner" class="start_banner" style="display:none">
    <div class="info">
      <span class="icon">üç™</span>
      <p>For optimal appearance and functionality, our website uses cookies.<br>Our cookies are purely functional and are not processed further.</p>
    </div>
    <button id="denie_cookies" class="secondary" type="button" name="button">Decline</button>
    <button id="accept_cookies" class="primary" type="button" name="button">Accept</button>
  </div>

  <div id="accepted_banner" class="start_banner" style="display:none" show-duration="4000">
    <div class="info">
      <span class="icon">üßô‚Äç‚ôÇÔ∏è</span>
      <p>Good choice! Our wizards are already at work on customizing the experience for you ‚ú®</p>
    </div>
    <div class="icons">
      <svg class="progress-ring banner_close_button" width="32" height="32">
        <circle class="progress-ring_circle" stroke-width="2" fill="transparent" r="10" cx="16" cy="16" />
        <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="19" y1="13" x2="13" y2="19"></line>
        <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="13" y1="13" x2="19" y2="19"></line>
      </svg>
    </div>
  </div>

  <div id="denied_banner" class="start_banner" style="display:none" show-duration="5000">
    <div class="info">
      <span class="icon">üëç</span>
      <p>Alright, you can change your preference at any time at the bottom right by hovering the cookie icon.</p>
    </div>
    <svg class="progress-ring banner_close_button" width="32" height="32">
      <circle class="progress-ring_circle" stroke-width="2" fill="transparent" r="10" cx="16" cy="16" />
      <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="19" y1="13" x2="13" y2="19"></line>
      <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="13" y1="13" x2="19" y2="19"></line>
    </svg>
  </div>

  <div id="welcome_banner" class="start_banner" style="display:none" show-duration="3500">
    <div class="info">
      <span class="icon">üëã</span>
      <p>Welcome back!</p>
    </div>
    <svg class="progress-ring banner_close_button" width="32" height="32">
      <circle class="progress-ring_circle" stroke-width="2" fill="transparent" r="10" cx="16" cy="16" />
      <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="19" y1="13" x2="13" y2="19"></line>
      <line stroke="var(--text-primary)" stroke-width="2" stroke-linecap="round" x1="13" y1="13" x2="19" y2="19"></line>
    </svg>
  </div>


  <div class="wrapper">
    <div class="introduction">
      <img src="img/logo/logo.svg" alt="">
      <h1>Automatic public transport planner for upcoming calendar events</h1>
      <p id="text">Just connect your calendar events and travent will find the perfect connection to go there and back for every event and directly add it to your calendar to block the time.</p>
    </div>
    <form action="javascript:sendForm()">
      <h3>Calendar</h3>
      <label for="source_cal">Source Calendar URL</label>
      <input type="text" id="source_cal" name="source_cal" value="" placeholder="e.g. https://splan.hdm-stuttgart.de/splan/ical?lan=de&puid=22&type=config&lc=,F3,b,n,Nf,ov,Dy,xn&oex=false">
      <span class="description">A link that links to an iCal download - Google Calendar tutorial: Go to your Calendar Settings and click "share publicly", then go down to calendar integrations and copy the link from "public
        address in iCal format".</span>

      <label for="destination_cal">Destination Calendar for the new entries</label>
      <div class="container">
        <div class="left">
          <div class="google_button" id="authorize_button"><img class="icon" src="img/google-icon-logo-svg-vector.svg" width="18px" height="18px" alt=""><span class="text">Connect your Google Calendar</span></div>
          <div class="google_button" id="signout_button" style="display: none;"><img class="icon" src="img/google-icon-logo-svg-vector.svg" width="18px" height="18px" alt=""><span class="text">Sign Out of Google Calendar</span></div>

          <!-- <input type="text" id="destination_cal" name="destination_cal" value="" placeholder="musterman@gmail.com"> -->
          <span class="description">The calendar in which the created events should be inserted.</span>
        </div>
        <span id="google_message" class="left"></span>
      </div>

      <h3>Location</h3>
      <div class="input_group horizontal">
        <div class="input">
          <label for="start">Start-Location</label>
          <input type="text" id="start" name="start" value="" placeholder="Musterstreet 7a, Stuttgart">
          <span class="description">Where you start to go to your events - most likely your home</span>
        </div>

        <div class="input">
          <label for="end">Destination-Location (optional)</label>
          <input type="text" id="end" name="end" value="" optional="true" placeholder="Musterstreet 7a, Stuttgart">
          <span class="description">The adress of your events. Only needed if not already in the calendar event or to override the calendar event location</span>
        </div>
      </div>

      <h3 id="optional_settings">Optional Settings</h3>
      <div class="input_group horizontal">
        <div class="input">
          <label for="buffer_before">Buffer before event</label>
          <input type="text" id="buffer_before" name="buffer_before" value="" optional="true" placeholder="5">
          <span class="description">If you want to have some buffer for delay or so put it here - normal is 5min</span>
        </div>
        <div class="input">
          <label for="buffer_after">Buffer after event</label>
          <input type="text" id="buffer_after" name="buffer_after" value="" optional="true" placeholder="5">
          <span class="description">If it ends later, you have some talks or so - normal is 5min</span>
        </div>
      </div>

      <label for="preferred">Preferred transportation mode</label>
      <select id="preferred" name="preferred">
        <option value="">Get the best one for me</option>
        <option value="BUS">Bus</option>
        <option value="RAIL">All rails: train, tram, light rail, and subway</option>
        <option value="TRAM">Tram and light rail</option>
        <option value="TRAIN">Train</option>
        <option value="SUBWAY">Subway</option>
      </select>
      <span class="description">If you prefer to drive by a specific vehicle you can set this here</span>

      <button type="submit">
        <div class="loader">
          <div class="container">
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
            <!-- <div class="ball"></div> -->
          </div>
        </div>
        <div class="done">‚úÖ</div>
        <span class="text">Create Events</span>
      </button>

    </form>




    <span id="debug_errors"></span>

  </div>

  <script src="js/customSelect.js"></script>


  <script type="text/javascript">
    // Client ID and API key from the Developer Console
    var CLIENT_ID = '109298445565-7pijc8i1mfpgqtebcolqoio6j14oddmf.apps.googleusercontent.com';
    var API_KEY = 'AIzaSyD428BZelApsygZBJJlGJXvmCzBNldPTSY';

    // Array of API discovery doc URLs for APIs used by the quickstart
    var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];

    // Authorization scopes required by the API; multiple scopes can be
    // included, separated by spaces.
    var SCOPES = "https://www.googleapis.com/auth/calendar";

    var authorizeButton = document.getElementById('authorize_button');
    var signoutButton = document.getElementById('signout_button');

    /**
     *  On load, called to load the auth2 library and API client library.
     */
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    /**
     *  Initializes the API client library and sets up sign-in state
     *  listeners.
     */
    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(function() {
        // Listen for sign-in state changes.
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

        // Handle the initial sign-in state.
        updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        authorizeButton.onclick = handleAuthClick;
        signoutButton.onclick = handleSignoutClick;
      }, function(error) {
        changeSpanText(JSON.stringify(error, null, 2));
      });
    }

    /**
     *  Called when the signed in status changes, to update the UI
     *  appropriately. After a sign-in, the API is called.
     */
    function updateSigninStatus(isSignedIn) {
      if (isSignedIn) {
        authorizeButton.style.display = 'none';
        signoutButton.style.display = 'flex';
        changeSpanText("üéâ You have been logged in succesfully");
        console.log(gapi.client.calendar.calendarList.list());
      } else {
        authorizeButton.style.display = 'flex';
        signoutButton.style.display = 'none';
        changeSpanText("");
      }
    }

    /**
     *  Sign in the user upon button click.
     */
    function handleAuthClick(event) {
      gapi.auth2.getAuthInstance().signIn();
    }

    /**
     *  Sign out the user upon button click.
     */
    function handleSignoutClick(event) {
      gapi.auth2.getAuthInstance().signOut();
    }

    /**
     * Append a pre element to the body containing the given message
     * as its text node. Used to display the results of the API call.
     *
     * @param {string} message Text to be placed in pre element.
     */
    function changeSpanText(message) {
      var pre = $('span#google_message');
      var textContent = document.createTextNode(message + '\n');
      pre.html(textContent);
    }
  </script>

  <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()">
  </script>



</body>

</html>